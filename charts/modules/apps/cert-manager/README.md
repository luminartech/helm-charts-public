# Cert Manager Module Chart

# Cross-Account DNS Zone Management

Module should allow sharing/using Route53-hosted DNS zone between AWS accounts.

You would need 2 application(sets) deployed:
1. 1+ instances with deploymentType set to issuer in AWS account that will use DNS shared zone
3. One cert-manager itself (deploymentType set to "app") in client account with next policy override:
   ```
   Policy:
     items:
       _:
         forProvider:
           policy:
             Statement:
               allowAssumeRole:
                 Effect: Allow
                 Action: sts:AssumeRole
                 # We would like to provide as least privileges as possible
                 Resource:
                   - 'arn:aws:iam::<ZoneHostAccountId>:role/<ZoneHostClientSpecificIAMRoleName>'
   ```

## Introduction

## Prerequisites

- Kubernetes 1.19+
- Helm 3.2.0+

## Using the Chart

## Parameters

### Global parameters

| Name                               | Description                                                                                                 | Value                                            |
| ---------------------------------- | ----------------------------------------------------------------------------------------------------------- | ------------------------------------------------ |
| `global.chartNameOverride`         | Overrides the chart name.                                                                                   | `""`                                             |
| `global.releaseNameOverride`       | Overrides the release name.                                                                                 | `""`                                             |
| `global.tags`                      | Define common tags for all IAC and app resources generated by this chart.                                   | `{}`                                             |
| `global.labels`                    | Define common labels for all IAC and app resources generated by this chart.                                 | `{}`                                             |
| `global.annotations`               | Define common annotations for all IAC and app resources generated by this chart.                            | `{}`                                             |
| `global.awsAccountId`              | Default aws account id for crossplane aws provider resources. Quotes are important, value must be a string. | `0123456789`                                     |
| `global.awsRegion`                 | Default aws region for crossplane aws provider resources.                                                   | `us-east-2`                                      |
| `global.eksHash`                   | Default EKS cluster hash for relevant crossplane resources such as IAM Role.                                | `XXXXX`                                          |
| `global.providerConfigRef.name`    | Default crossplane provider all resources generated for crossplane.                                         | `aws-{{ .Values.global.awsAccountId }}`          |
| `global.logLevel`                  | Set log level to 2 for normal mode and 6 for debug mode.                                                    | `6`                                              |
| `global.deploymentName`            | Deployment name for the app.                                                                                | `cert-manager`                                   |
| `global.issuerCertManagerRoleName` | Role name used by issuer's cert-manager to access shared DNS zone.                                          | `tenant-role`                                    |
| `global.team`                      | Team.                                                                                                       | `test`                                           |
| `global.environment`               | Environment.                                                                                                | `dev`                                            |
| `global.dnsZoneAwsAccountId`       | Default allowed record names.                                                                               | `0123456789`                                     |
| `global.dnsZoneAwsRegion`          | Aws region where zone is hosted.                                                                            | `us-west-2`                                      |
| `global.dnsZoneName`               | Zone name to be managed.                                                                                    | `example.com`                                    |
| `global.letsencryptServer`         | ServerURL used by Letsencrypt.                                                                              | `https://acme-v02.api.letsencrypt.org/directory` |
| `global.letsencryptAdminEmail`     | Admin email used by Letsencrypt.                                                                            | `test@example.com`                               |
| `global.deploymentType`            | Type of deployment, either app, issuer or anything else.                                                    | `app`                                            |


### cert-manager configurations




### Certificate configurations




### CertificateRequest configurations




### ClusterIssuer configurations




### Issuer configurations




### external-dns basic configuration




### AWS IAM configurations











## Configuration and installation details


## Troubleshooting


## Notable changes
