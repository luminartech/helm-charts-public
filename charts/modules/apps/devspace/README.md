# Devspace Module Chart

## TL;DR

## Introduction

## Prerequisites

- Kubernetes 1.23+
- Helm 3.2.0+

## Using the Chart

## Parameters

### Global parameters

| Name                            | Description                                                                      | Value                                            |
| ------------------------------- | -------------------------------------------------------------------------------- | ------------------------------------------------ |
| `global.chartNameOverride`      | Overrides the chart name.                                                        | `""`                                             |
| `global.releaseNameOverride`    | Overrides the release name.                                                      | `""`                                             |
| `global.tags`                   | Define common tags for all IAC and app resources generated by this chart.        | `{}`                                             |
| `global.labels`                 | Define common labels for all IAC and app resources generated by this chart.      | `{}`                                             |
| `global.annotations`            | Define common annotations for all IAC and app resources generated by this chart. | `{}`                                             |
| `global.environment`            | Application environment                                                          | `dev`                                            |
| `global.IAMRole`                | Default IAM role ARN for pod                                                     | `arn:aws:iam::AWS-ACCOUNT-ID:role/IAM-ROLE-NAME` |
| `global.persistentDataDiskSize` | Persistent volume size for the pod                                               | `10Gi`                                           |
| `global.storageClassName`       | Persistent volume claim class                                                    | `gp3-persistent-125`                             |
| `global.images.devcontainer`    | Devcontainer image                                                               | `satishweb/devops-tools:latest`                  |
| `global.env.FIXUID`             | Fix UID for the persistent volume mount                                          | `1000`                                           |
| `global.env.FIXGID`             | Fix GID for the persistent volume mount                                          | `1000`                                           |
| `global.env.HOME`               | Default home directory path for the container                                    | `/persistent-data`                               |


### Devspace configurations

| Name                                                                                 | Description                                                                                    | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `common-res.enabled`                                                                 | Toggle for enabling or disabling chatbot ui resources.                                         | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.automountServiceAccountToken`                           | Automount Service account token                                                                | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `common-res.Pod.items._.spec.restartPolicy`                                          | Restart policy for the pod                                                                     | `Never`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `common-res.Pod.items._.spec.securityContext.fsGroup`                                | Specify the default fs group id                                                                | `1000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.securityContext.supplementalGroups`                     | Specify the additional groups                                                                  | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `common-res.Pod.items._.spec.securityContext.fsGroupChangePolicy`                    | Specify the default gs group change policy                                                     | `OnRootMismatch`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `common-res.Pod.items._.spec.containers[0].name`                                     |                                                                                                | `container-0`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `common-res.Pod.items._.spec.containers[0].image`                                    |                                                                                                | `{{ .Values.global.images.devcontainer }}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `common-res.Pod.items._.spec.containers[0].imagePullPolicy`                          | Container image pullPolicy. Allowed values: `IfNotPresent`, `Always`, `Never`                  | `IfNotPresent`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `common-res.Pod.items._.spec.containers[0].tty`                                      | Determines whether containers in a pod runs with TTY enabled.                                  | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].stdin`                                    | Determines whether containers in a pod runs with stdin enabled.                                | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].ports[0].name`                            | Name of the port                                                                               | `http`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].ports[0].containerPort`                   | The port number                                                                                | `8080`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].ports[0].protocol`                        | Port protocol. Allowed values: "SCTP", `TCP` and `UDP`.                                        | `TCP`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `common-res.Pod.items._.spec.containers[0].resources.limits.cpu`                     | CPU limits                                                                                     | `1`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `common-res.Pod.items._.spec.containers[0].resources.limits.memory`                  | Memory limits                                                                                  | `512Mi`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `common-res.Pod.items._.spec.containers[0].resources.requests.cpu`                   | CPU requests                                                                                   | `1`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `common-res.Pod.items._.spec.containers[0].resources.requests.memory`                | Memory requests                                                                                | `512Mi`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `common-res.Pod.items._.spec.containers[0].securityContext.runAsGroup`               | Specify the default user group id                                                              | `1000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].securityContext.runAsUser`                | Specify the default user id                                                                    | `1000`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].securityContext.privileged`               | Privileged mode true or false. Allowed values: `true` or `false`                               | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `common-res.Pod.items._.spec.containers[0].securityContext.readOnlyRootFilesystem`   | Access level for the file system.  Allowed values: `true` or `false`                           | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `common-res.Pod.items._.spec.containers[0].securityContext.allowPrivilegeEscalation` | Allow escalation of privileges true or false. Allowed values: `true` or `false`                | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].securityContext.runAsNonRoot`             | Run the process as root, true or false. Allowed values: `true` or `false`                      | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Pod.items._.spec.containers[0].securityContext.seccompProfile.type`      | Seccomp profile type                                                                           | `RuntimeDefault`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `common-res.Pod.items._.spec.containers[0].securityContext.capabilities.drop`        | Capabilities to drop                                                                           | `["ALL"]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `common-res.Pod.items._.spec.containers[0].securityContext.capabilities.add`         | Capabilities to add                                                                            | `["SYS_ADMIN","CAP_CHOWN","CAP_KILL","CAP_MKNOD","CAP_PERFMON","CAP_SETGID","CAP_SETPCAP"]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `common-res.ConfigMap.enabled`                                                       | Enable or Disable the configmap from being created. Allowed values: `true` or `false`          | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.ConfigMap.items._.data.init-script.sh`                                   |                                                                                                | `#!/bin/bash
# Define the source and destination directories
src_dir="/home/devops"
dest_dir="/persistent-data"
sed -i 's/DEVOPS/DEV-ENV/g' /home/devops/.zshrc || true
# Define directories and files to be copied
items_to_copy=(
    "$src_dir/.oh-my-zsh"
    "$src_dir/.cache"
    "$src_dir/.local"
    "$src_dir/.config"
    "$src_dir/.krew"
    "$src_dir/.aws_cli_functions"
    "$src_dir/.kubectl_aliases"
    "$src_dir/.tmux.conf"
    "$src_dir/.vimrc"
    "$src_dir/.wget-hsts"
    "$src_dir/.zshrc"
)
# Copy items if they don't exist in the destination
for item in "${items_to_copy[@]}"; do
    if [ ! -e "$dest_dir/$(basename "$item")" ]; then
        cp -rf "$item" "$dest_dir" || true
    fi
done
if [ ! -f "$dest_dir/.keep" ]; then
    touch "$dest_dir/.keep"
    chown -Rf 1000:1000 "$dest_dir"
fi
` |
| `common-res.ConfigMap.items._.data.entrypoint-script.sh`                             |                                                                                                | `#!/bin/bash
eval "$(/usr/local/bin/fixuid -q)" || true
# Generate default gpg key without the password
if [ ! -f ${HOME}/.gnupg/pubring.kbx ]; then
    gpg --batch --passphrase '' --quick-gen-key devops default default
fi
# Run gpg command to make sure gpg agent starts in a daemon mode.
gpg --list-secret-keys >/dev/null 2>&1

# Initialize pass manager with default gpg id
if [ ! -f ${HOME}/.password-store/.gpg-id ]; then
    pass init $(gpg --list-keys devops|awk 'NR==2{print $1;exit}')
fi
sleep infinity
`                                                                                                                                                                                                                                                                                                           |
| `common-res.PersistentVolumeClaim.enabled`                                           | Specifies whether PersistentVolumeClaims should be created. Allowed values: `true` or `false`  | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.ServiceAccount.items._.enabled`                                          | Specifies whether a service account should be created. Allowed values: `true` or `false`       | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.ServiceAccount.items._.annotations.eks.amazonaws.com/role-arn`           | The AWS IAM role ARN for service account of the pod                                            | `{{ .Values.global.IAMRoleARN }}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `common-res.Service.items._.enabled`                                                 | Enables or disables the service                                                                | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Service.items._.spec.selector`                                           | Additional selectors                                                                           | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `common-res.Service.items._.spec.type`                                               | Set the service type                                                                           | `ClusterIP`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `common-res.Service.items._.spec.ipFamilyPolicy`                                     | Specify the ip policy. Options: SingleStack, PreferDualStack, RequireDualStack                 | `SingleStack`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `common-res.Service.items._.spec.ports[0].name`                                      | The port number                                                                                | `http`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Service.items._.spec.ports[0].port`                                      | The port number                                                                                | `8080`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `common-res.Service.items._.spec.ports[0].protocol`                                  | Port protocol. Allowed values: `TCP`, `SCTP` or `UDP`.                                         | `TCP`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `common-res.Service.items._.spec.ports[0].targetPort`                                | Specify a service targetPort if you wish to differ the service port from the application port. | `8080`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |


## Configuration and installation details


## Troubleshooting


## Notable changes
